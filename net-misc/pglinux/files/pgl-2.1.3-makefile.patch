--- Makefile.old	2011-09-17 16:11:24.000000000 +0200
+++ Makefile	2012-01-16 17:10:55.710224707 +0100
@@ -8,10 +8,6 @@
 VERSION = 2.1.3
 SHELL = /bin/sh
 
-# Compilation settings
-CFLAGS=-Wall
-OPTFLAGS=-Os
-
 #
 # Set which pgl modules shall be built
 #
--- pgld/Makefile.old	2011-09-17 16:11:24.000000000 +0200
+++ pgld/Makefile	2012-01-17 18:48:34.371098035 +0100
@@ -3,7 +3,7 @@
 # This Makefile gets executed by the main pgl Makefile. Don't execute it directly!
 # TODO: check this: ifeq (0,${MAKELEVEL})
 
-CC=gcc
+CC?=gcc
 CFLAGS+= \
 	-DVERSION=\"$(VERSION)\" \
 	-DPACKAGE_NAME=\"$(PKGNAME)\" \
@@ -76,7 +76,7 @@
 	$(CC) -o $@ $^ $(CFLAGS) $(LDFLAGS) $(LIBS)
 
 src/dbus.so: src/dbus.o
-	$(CC) -o $@ $^ $(CFLAGS) -shared
+	$(CC) -o $@ $^ $(CFLAGS) $(LDFLAGS) -shared
 
 clean:
 	rm -rf *~ \
--- pgl-gui/Makefile.old	2011-09-17 16:11:24.000000000 +0200
+++ pgl-gui/Makefile	2012-01-17 18:10:37.091993477 +0100
@@ -3,18 +3,15 @@
 # This Makefile gets executed by the main pgl Makefile. Don't execute it directly!
 # TODO: check this: ifeq (0,${MAKELEVEL})
 
-CC=g++
+CXX?=g++
 MOC=moc
 UIC=uic
 RCC=rcc
 
-# CFLAGS += \
-# LDFLAGS += \
-
-QTDIR:=/usr/share/qt4
-QTINC:=$(QTDIR)/include
+QTINC:=/usr/include/qt4
 INCPATH:=\
 	-I$(QTINC) \
+	-I$(QTINC)/Qt \
 	-I$(QTINC)/QtCore \
 	-I$(QTINC)/QtGui \
 	-I$(QTINC)/QtDBus\
@@ -36,17 +33,17 @@
 # endif
 
 ifeq ($(PROFILE),yes)
-CFLAGS+=-pg
+CXXFLAGS+=-pg
 LDFLAGS+=-pg
 endif
 
 ifeq ($(DEBUG),yes)
-CFLAGS+=-ggdb3
+CXXFLAGS+=-ggdb3
 LDFLAGS+=-ggdb3
 OPTFLAGS=-O0
 endif
 
-CFLAGS+=$(OPTFLAGS)
+CXXFLAGS+=$(OPTFLAGS)
 
 # source (.cpp files) with header (.h) file in folder src/
 # so main.cpp is missing here because it has no header file
@@ -93,12 +90,13 @@
 #   build/obj/qrc_images.o
 #   -L/usr/lib -lQtGui -lQtNetwork -lQtCore -lpthread
 pgl-gui: $(SOURCESDIR)/main.o $(SOURCES:cpp=o) $(MOC_SOURCES_OBJECTS) qrc_images.o
-	$(CC) \
+	$(CXX) $(CXXFLAGS) \
 		$(SOURCESDIR)/main.o \
 		$(SOURCES:cpp=o) \
 		$(MOC_SOURCES_OBJECTS) \
 		qrc_images.o \
-		-L/usr/lib -lQtDBus -lQtGui -lQtCore -lpthread \
+		$(LDFLAGS) \
+		-L/usr/@LIB@/qt4 -lQtDBus -lQtGui -lQtCore -lpthread \
 		-o $@
 
 # objects of main and SOURCES
@@ -112,8 +110,8 @@
 #  -o build/obj/add_exception_dialog.o
 #  src/add_exception_dialog.cpp
 $(SOURCESDIR)/main.o $(SOURCES:cpp=o): %.o: %.cpp $(FORMS_HEADERS)
-	$(CC) \
-		-pipe -g -D_REENTRANT -Wall -W -DQT_GUI_LIB -DQT_NETWORK_LIB -DQT_CORE_LIB -DQT_SHARED \
+	$(CXX) $(CXXFLAGS) \
+		-D_REENTRANT -Wall -W -DQT_GUI_LIB -DQT_NETWORK_LIB -DQT_CORE_LIB -DQT_SHARED \
 		$(INCPATH) \
 		-c $< \
 		-o $@
@@ -146,8 +144,8 @@
 #  -o build/obj/moc_add_exception_dialog.o
 #  build/moc/moc_add_exception_dialog.cpp
 $(MOC_SOURCES_OBJECTS): $(SOURCESDIR)/moc_%.o: $(SOURCESDIR)/moc_%.cpp $(FORMS_HEADERS)
-	$(CC) \
-		-pipe -g -D_REENTRANT -Wall -W -DQT_GUI_LIB -DQT_NETWORK_LIB -DQT_CORE_LIB -DQT_SHARED \
+	$(CXX) $(CXXFLAGS) \
+		-D_REENTRANT -Wall -W -DQT_GUI_LIB -DQT_NETWORK_LIB -DQT_CORE_LIB -DQT_SHARED \
 		$(INCPATH) \
 		-c $< \
 		-o $@
@@ -172,8 +170,8 @@
 #  -o build/obj/qrc_images.o
 #  qrc_images.cpp
 qrc_images.o: qrc_images.cpp
-	$(CC) \
-		-pipe -g -D_REENTRANT -Wall -W -DQT_GUI_LIB -DQT_NETWORK_LIB -DQT_CORE_LIB -DQT_SHARED \
+	$(CXX) $(CXXFLAGS) \
+		-D_REENTRANT -Wall -W -DQT_GUI_LIB -DQT_NETWORK_LIB -DQT_CORE_LIB -DQT_SHARED \
 		$(INCPATH) \
 		-c qrc_images.cpp \
 		-o qrc_images.o
